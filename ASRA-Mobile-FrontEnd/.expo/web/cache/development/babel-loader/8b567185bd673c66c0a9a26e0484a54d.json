{"ast":null,"code":"\"use strict\";\n\nvar _defineProperty = require(\"@babel/runtime/helpers/defineProperty\");\n\nvar _objectWithoutProperties = require(\"@babel/runtime/helpers/objectWithoutProperties\");\n\nvar _excluded = [\"source\"],\n    _excluded2 = [\"onDocumentMetadataLoaded\", \"onTTreeChange\", \"contentWidth\"],\n    _excluded3 = [\"source\"],\n    _excluded4 = [\"source\"];\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.renderSourcePropTypes = void 0;\n\nvar _equals = _interopRequireDefault(require(\"ramda/src/equals\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _reactNative = require(\"react-native-web/dist/index\");\n\nvar _propTypes = _interopRequireDefault(require(\"prop-types\"));\n\nvar _ttreeEventsContext = _interopRequireDefault(require(\"./context/ttreeEventsContext\"));\n\nvar _isUriSource = _interopRequireDefault(require(\"./helpers/isUriSource\"));\n\nvar _SourceLoaderUri = _interopRequireDefault(require(\"./SourceLoaderUri\"));\n\nvar _SourceLoaderInline = _interopRequireDefault(require(\"./SourceLoaderInline\"));\n\nvar _SourceLoaderDom = _interopRequireDefault(require(\"./SourceLoaderDom\"));\n\nvar _debugMessages = _interopRequireDefault(require(\"./debugMessages\"));\n\nvar _contentWidthContext = _interopRequireDefault(require(\"./context/contentWidthContext\"));\n\nvar _isDomSource = _interopRequireDefault(require(\"./helpers/isDomSource\"));\n\nvar _useProfiler = _interopRequireDefault(require(\"./hooks/useProfiler\"));\n\nfunction _getRequireWildcardCache(nodeInterop) {\n  if (typeof WeakMap !== \"function\") return null;\n  var cacheBabelInterop = new WeakMap();\n  var cacheNodeInterop = new WeakMap();\n  return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) {\n    return nodeInterop ? cacheNodeInterop : cacheBabelInterop;\n  })(nodeInterop);\n}\n\nfunction _interopRequireWildcard(obj, nodeInterop) {\n  if (!nodeInterop && obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") {\n    return {\n      default: obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache(nodeInterop);\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj.default = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nvar renderSourcePropTypes = {\n  source: _propTypes.default.oneOfType([_propTypes.default.shape({\n    html: _propTypes.default.string.isRequired,\n    baseUrl: _propTypes.default.string\n  }), _propTypes.default.shape({\n    dom: _propTypes.default.object.isRequired,\n    baseUrl: _propTypes.default.string\n  }), _propTypes.default.shape({\n    uri: _propTypes.default.string.isRequired,\n    method: _propTypes.default.string,\n    body: _propTypes.default.any,\n    headers: _propTypes.default.object\n  })]),\n  onTTreeChange: _propTypes.default.func,\n  onHTMLLoaded: _propTypes.default.func,\n  onDocumentMetadataLoaded: _propTypes.default.func,\n  contentWidth: _propTypes.default.number\n};\nexports.renderSourcePropTypes = renderSourcePropTypes;\n\nfunction isEmptySource(source) {\n  return !source || typeof source.uri !== 'string' && typeof source.html !== 'string' && !source.dom;\n}\n\nfunction RawSourceLoader(_ref) {\n  var source = _ref.source,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  if (isEmptySource(source)) {\n    if (typeof __DEV__ === 'boolean' && __DEV__) {\n      console.warn(_debugMessages.default.noSource);\n    }\n\n    return null;\n  }\n\n  if ((0, _isUriSource.default)(source)) {\n    return _react.default.createElement(_SourceLoaderUri.default, _objectSpread({\n      source: source\n    }, props));\n  }\n\n  if ((0, _isDomSource.default)(source)) {\n    return _react.default.createElement(_SourceLoaderDom.default, _objectSpread({\n      source: source\n    }, props));\n  }\n\n  return _react.default.createElement(_SourceLoaderInline.default, _objectSpread({\n    source: source\n  }, props));\n}\n\nfunction shallowEqual(prop1, prop2) {\n  if (!(0, _equals.default)(Object.keys(prop1), Object.keys(prop2))) {\n    return false;\n  }\n\n  for (var key in prop1) {\n    if (prop1[key] !== prop2[key]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nvar RenderHTMLSource = (0, _react.memo)(function RenderHtmlSource(_ref2) {\n  var onDocumentMetadataLoaded = _ref2.onDocumentMetadataLoaded,\n      onTTreeChange = _ref2.onTTreeChange,\n      contentWidth = _ref2.contentWidth,\n      props = _objectWithoutProperties(_ref2, _excluded2);\n\n  var profile = (0, _useProfiler.default)({\n    prop: 'onDocumentMetadataLoaded or onTTreeChange'\n  });\n  var ttreeEvents = (0, _react.useMemo)(function () {\n    typeof __DEV__ === 'boolean' && __DEV__ && profile();\n    return {\n      onDocumentMetadataLoaded: onDocumentMetadataLoaded,\n      onTTreeChange: onTTreeChange\n    };\n  }, [onDocumentMetadataLoaded, onTTreeChange, profile]);\n\n  if (typeof __DEV__ === 'boolean' && __DEV__) {\n    if (!(typeof contentWidth === 'number')) {\n      console.warn(_debugMessages.default.contentWidth);\n    }\n  }\n\n  return _react.default.createElement(_ttreeEventsContext.default.Provider, {\n    value: ttreeEvents\n  }, _react.default.createElement(_contentWidthContext.default.Provider, {\n    value: contentWidth || _reactNative.Dimensions.get('window').width\n  }, _react.default.createElement(RawSourceLoader, props)));\n}, function (_ref3, _ref4) {\n  var currSource = _ref4.source,\n      curr = _objectWithoutProperties(_ref4, _excluded3);\n\n  var prevSource = _ref3.source,\n      prev = _objectWithoutProperties(_ref3, _excluded4);\n\n  return shallowEqual(prevSource, currSource) && shallowEqual(prev, curr);\n});\nRenderHTMLSource.propTypes = renderSourcePropTypes;\nvar _default = RenderHTMLSource;\nexports.default = _default;","map":{"version":3,"sources":["RenderHTMLSource.tsx"],"names":["renderSourcePropTypes","source","html","PropTypes","baseUrl","string","dom","uri","method","body","headers","object","onTTreeChange","onHTMLLoaded","onDocumentMetadataLoaded","contentWidth","number","props","isEmptySource","console","debugMessage","SourceLoaderUri","SourceLoaderDom","SourceLoaderInline","Object","prop1","prop2","RenderHTMLSource","profile","prop","ttreeEvents","Dimensions","width","React","prev","curr","shallowEqual"],"mappings":"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","sourcesContent":["import equals from 'ramda/src/equals';\nimport React, { memo, ReactElement, useMemo } from 'react';\nimport { Dimensions } from 'react-native';\nimport PropTypes from 'prop-types';\nimport ttreeEventsContext from './context/ttreeEventsContext';\nimport isUriSource from './helpers/isUriSource';\nimport { SourceLoaderProps, TTreeEvents } from './internal-types';\nimport {\n  HTMLSourceDom,\n  HTMLSourceInline,\n  RenderHTMLSourceProps,\n  HTMLSourceUri,\n  HTMLSource\n} from './shared-types';\nimport SourceLoaderUri from './SourceLoaderUri';\nimport SourceLoaderInline from './SourceLoaderInline';\nimport SourceLoaderDom from './SourceLoaderDom';\nimport debugMessage from './debugMessages';\nimport contentWidthContext from './context/contentWidthContext';\nimport isDomSource from './helpers/isDomSource';\nimport useProfiler from './hooks/useProfiler';\n\nexport type RenderHTMLSourcePropTypes = Record<\n  keyof RenderHTMLSourceProps,\n  any\n>;\n\nexport const renderSourcePropTypes: RenderHTMLSourcePropTypes = {\n  source: PropTypes.oneOfType([\n    PropTypes.shape({\n      html: PropTypes.string.isRequired,\n      baseUrl: PropTypes.string\n    }),\n    PropTypes.shape({\n      dom: PropTypes.object.isRequired,\n      baseUrl: PropTypes.string\n    }),\n    PropTypes.shape({\n      uri: PropTypes.string.isRequired,\n      method: PropTypes.string,\n      body: PropTypes.any,\n      headers: PropTypes.object\n    })\n  ]),\n  onTTreeChange: PropTypes.func,\n  onHTMLLoaded: PropTypes.func,\n  onDocumentMetadataLoaded: PropTypes.func,\n  contentWidth: PropTypes.number\n};\n\nfunction isEmptySource(source: undefined | HTMLSource) {\n  return (\n    !source ||\n    (typeof (source as HTMLSourceUri).uri !== 'string' &&\n      typeof (source as HTMLSourceInline).html !== 'string' &&\n      !(source as HTMLSourceDom).dom)\n  );\n}\n\nfunction RawSourceLoader({\n  source,\n  ...props\n}: SourceLoaderProps): ReactElement | null {\n  if (isEmptySource(source)) {\n    /* istanbul ignore next */\n    if (typeof __DEV__ === 'boolean' && __DEV__) {\n      console.warn(debugMessage.noSource);\n    }\n    return null;\n  }\n  if (isUriSource(source)) {\n    return React.createElement(SourceLoaderUri, { source, ...props });\n  }\n  if (isDomSource(source)) {\n    return React.createElement(SourceLoaderDom, { source, ...props });\n  }\n  return React.createElement(SourceLoaderInline, { source, ...props });\n}\n\n// check if for each key of two objects, the values are equal\nfunction shallowEqual(prop1: any, prop2: any) {\n  if (!equals(Object.keys(prop1), Object.keys(prop2))) {\n    return false;\n  }\n  for (const key in prop1) {\n    if (prop1[key] !== prop2[key]) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/**\n * A React component to render HTML snippets.\n *\n * @remarks This component is useful when you have to load dozens of HTML\n * snippets with the same config. Performance is expected to improve in such\n * scenarios.\n *\n * @warning This component requires to have {@link TRenderEngineProvider}\n * and {@link RenderHTMLConfigProvider} as parents.\n */\nconst RenderHTMLSource = memo(\n  function RenderHtmlSource({\n    onDocumentMetadataLoaded,\n    onTTreeChange,\n    contentWidth,\n    ...props\n  }: RenderHTMLSourceProps) {\n    const profile = useProfiler({\n      prop: 'onDocumentMetadataLoaded or onTTreeChange'\n    });\n    const ttreeEvents: TTreeEvents = useMemo(() => {\n      typeof __DEV__ === 'boolean' && __DEV__ && profile();\n      return {\n        onDocumentMetadataLoaded,\n        onTTreeChange\n      };\n    }, [onDocumentMetadataLoaded, onTTreeChange, profile]);\n    if (typeof __DEV__ === 'boolean' && __DEV__) {\n      if (!(typeof contentWidth === 'number')) {\n        console.warn(debugMessage.contentWidth);\n      }\n    }\n    return (\n      <ttreeEventsContext.Provider value={ttreeEvents}>\n        <contentWidthContext.Provider\n          value={contentWidth || Dimensions.get('window').width}>\n          {React.createElement(RawSourceLoader, props)}\n        </contentWidthContext.Provider>\n      </ttreeEventsContext.Provider>\n    );\n  },\n  ({ source: prevSource, ...prev }, { source: currSource, ...curr }) => {\n    return shallowEqual(prevSource, currSource) && shallowEqual(prev, curr);\n  }\n);\n\n/**\n * @ignore\n */\n(RenderHTMLSource as any).propTypes = renderSourcePropTypes;\n\nexport default RenderHTMLSource;\n"]},"metadata":{},"sourceType":"script"}